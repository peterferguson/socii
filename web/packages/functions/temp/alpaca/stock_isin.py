import pandas as pd
from tqdm import tqdm

missing_isins = [
    "ARCA:TMF",
    "NYSE:BGT",
    "NYSE:BKT",
    "NASDAQ:BIB",
    "ARCA:BNDC",
    "NYSE:BUI",
    "NYSE:BTZ",
    "NYSE:BXMX",
    "NYSE:CEM",
    "ARCA:BRZU",
    "NYSE:BTA",
    "NYSE:KF",
    "NYSE:BWG",
    "NASDAQ:CGO",
    "NASDAQ:CHW",
    "NYSE:BLE",
    "NYSE:BOE",
    "NYSE:BWSN",
    "NYSE:BTT",
    "ARCA:BZQ",
    "NYSE:BSL",
    "NYSE:CAF",
    "ARCA:BTAL",
    "ARCA:CEFD",
    "ARCA:CHAD",
    "NASDAQ:CNFRL",
    "NYSE:BYM",
    "ARCA:CLDS",
    "NYSE:CMSD",
    "NASDAQ:CPTAG",
    "ARCA:COW",
    "ARCA:CORN",
    "BATS:CSM",
    "NYSE:CIF",
    "NYSE:CMSA",
    "ARCA:CORP",
    "NASDAQ:CSSEN",
    "NYSE:CTR",
    "NYSE:CUBB",
    "NASDAQ:CPZ",
    "ARCA:CYB",
    "NASDAQ:CUBA",
    "ARCA:DBB",
    "ARCA:DFEN",
    "BATS:DDWM",
    "ARCA:CROC",
    "NASDAQ:CSQ",
    "NASDAQ:CXSE",
    "ARCA:DBA",
    "NYSE:DCF",
    "NYSE:CTDD",
    "ARCA:DNL",
    "ARCA:CURE",
    "NYSE:CXH",
    "NYSE:DBL",
    "ARCA:DES",
    "ARCA:DFE",
    "ARCA:DUSL",
    "NYSE:EEA",
    "NYSE:CTBB",
    "ARCA:DBP",
    "ARCA:DDM",
    "NYSE:DIAX",
    "NYSE:DRUA",
    "ARCA:DOG",
    "NYSE:CXE",
    "NYSE:DHF",
    "NYSE:DFP",
    "ARCA:DBE",
    "NASDAQ:DHCNL",
    "NYSE:DSM",
    "ARCA:DRN",
    "ARCA:DBC",
    "ARCA:DDG",
    "ARCA:DGL",
    "NASDAQ:DGRE",
    "ARCA:DTH",
    "NYSE:EFL",
    "NYSE:DMO",
    "NYSE:DNP",
    "ARCA:DIVA",
    "NYSE:DTF",
    "ARCA:DMCY",
    "NYSE:DSU",
    "ARCA:DWM",
    "ARCA:EDC",
    "ARCA:EFZ",
    "NASDAQ:FAB",
    "NASDAQ:FEM",
    "NYSE:EXD",
    "ARCA:DWMF",
    "NASDAQ:DXJS",
    "NYSE:EDI",
    "NYSE:EHI",
    "NYSE:EDD",
    "NYSE:ETX",
    "NASDAQ:FEP",
    "ARCA:FDM",
    "NYSE:FTHY",
    "ARCA:FXY",
    "ARCA:DOO",
    "ARCA:EFU",
    "ARCA:EZM",
    "NYSE:FDEU",
    "NASDAQ:FPA",
    "NYSE:GF",
    "NYSE:GJO",
    "NYSE:GER",
    "NYSE:GUT",
    "NYSE:EXG",
    "ARCA:FAZ",
    "NYSE:FPF",
    "ARCA:FXH",
    "ARCA:GAZ",
    "NYSE:HTY",
    "ARCA:IAUM",
    "NYSE:ETJ",
    "NASDAQ:FDT",
    "NYSE:FEO",
    "NASDAQ:FDTS",
    "ARCA:FXD",
    "NASDAQ:FYT",
    "ARCA:FXC",
    "NYSE:GNT",
    "NYSE:IDE",
    "NYSE:IIF",
    "NYSE:IIM",
    "NASDAQ:INBKL",
    "NASDAQ:GBRGR",
    "BATS:HYIN",
    "ARCA:HYGV",
    "NYSE:IGA",
    "NYSE:IGR",
    "ARCA:INDL",
    "ARCA:IQDF",
    "ARCA:IQDE",
    "ARCA:GRN",
    "ARCA:HYS",
    "BATS:IGHG",
    "NASDAQ:JMPNZ",
    "NYSE:JGH",
    "NYSE:JHAA",
    "ARCA:JJU",
    "NYSE:JMM",
    "NYSE:JOF",
    "NYSE:KKRS",
    "ARCA:JJT",
    "NYSE:JTD",
    "NYSE:JHI",
    "ARCA:JNUG",
    "NYSE:JEMD",
    "ARCA:JJM",
    "ARCA:JJP",
    "NYSE:JPI",
    "NYSE:JPT",
    "NYSE:KMF",
    "ARCA:KORU",
    "NASDAQ:JMPNL",
    "ARCA:KOLD",
    "NYSE:KSM",
    "NYSE:KTN",
    "NYSE:KTF",
    "NYSE:LDP",
    "NYSE:KIO",
    "ARCA:LBJ",
    "BATS:LKOR",
    "NYSE:MHN",
    "ARCA:MBSD",
    "ARCA:MCRO",
    "NYSE:MHF",
    "NYSE:MYC",
    "NASDAQ:NEWTL",
    "NYSE:MHNC",
    "NYSE:MCI",
    "NYSE:MIE",
    "ARCA:MJO",
    "NYSE:MQY",
    "NYSE:MXE",
    "NYSE:MGR",
    "NYSE:MHI",
    "ARCA:MJJ",
    "ARCA:MLPR",
    "NYSE:NIE",
    "NASDAQ:MDIV",
    "NYSE:MGU",
    "NYSE:MIN",
    "NYSE:MPV",
    "NYSE:MYN",
    "NYSE:NAD",
    "ARCA:MINT",
    "NYSE:MUE",
    "NYSE:MUJ",
    "NYSE:NEA",
    "NASDAQ:NEWTZ",
    "NYSE:NXQ",
    "NASDAQ:OFSSG",
    "ARCA:OIL",
    "ARCA:MLPB",
    "NYSE:MUC",
    "NYSE:NDMO",
    "NYSE:NFJ",
    "NYSE:MNP",
    "ARCA:MZZ",
    "NYSE:NCZ",
    "NYSE:NGC.U",
    "ARCA:NFRA",
    "NASDAQ:OFSSI",
    "NASDAQ:OXSQZ",
    "NYSE:PCQ",
    "NYSE:NIQ",
    "NYSE:NMI",
    "NYSE:NXJ",
    "NYSE:PAI",
    "NYSE:NKX",
    "NYSE:NMS",
    "ARCA:OGCP",
    "NYSE:NMCO",
    "NYSE:PDO",
    "NYSE:PFD",
    "NASDAQ:OXSQG",
    "NYSE:PMF",
    "ARCA:PHYS",
    "NYSE:PMX",
    "NYSE:RIV",
    "ARCA:SPXL",
    "NYSE:RCA",
    "NYSE:RFMZ",
    "ARCA:TBT",
    "NYSE:PML",
    "ARCA:PYPE",
    "ARCA:QULL",
    "ARCA:RFCI",
    "ARCA:RJN",
    "NASDAQ:RILYG",
    "NYSE:THW",
    "NYSE:GPM",
    "ARCA:TWM",
    "ARCA:ULE",
    "ARCA:UPRO",
    "ARCA:UMDD",
    "ARCA:USFR",
    "ARCA:GRES",
    "ARCA:UDN",
    "NYSE:TWN",
    "NYSE:BGY",
    "NASDAQ:TUR",
    "NYSE:TY",
    "ARCA:UNG",
    "ARCA:USML",
    "ARCA:UPV",
    "NYSE:BGIO",
    "NYSE:WIW",
    "NYSE:TVC",
    "ARCA:UJB",
    "ARCA:UNL",
    "ARCA:UMI",
    "NYSE:BGB",
    "NASDAQ:CCD",
    "ARCA:UST",
    "NYSE:BIF",
    "NYSE:BFZ",
    "NYSE:CELG.RT",
    "ARCA:GQRE",
    "NYSE:MFM",
    "ARCA:MEXX",
    "NASDAQ:USOI",
    "NASDAQ:CHY",
    "ARCA:HIBS",
    "NYSE:GJP",
    "NYSE:HIO",
    "NYSE:BFK",
    "NYSE:BHV",
    "NYSE:HPS",
    "NYSE:GHY",
    "NYSE:HQH",
    "NYSE:HGLB",
    "NYSE:IGD",
    "NYSE:FAM",
    "NASDAQ:FYC",
    "NYSE:AIO",
    "NYSE:BAMH",
    "ARCA:BOIL",
    "NASDAQ:ALACR",
    "NYSE:BBN",
    "ARCA:BOND",
    "NASDAQ:CARZ",
    "ARCA:CCOR",
    "NYSE:CEE",
    "ARCA:DEM",
    "NYSE:BEPH",
    "ARCA:BDCZ",
    "NYSE:BSA",
    "ARCA:BAL",
    "NASDAQ:BICK",
    "NYSE:BIGZ",
    "NYSE:CMSC",
    "ARCA:DFJ",
    "NASDAQ:CGABL",
    "NASDAQ:COWNL",
    "ARCA:DEW",
    "NASDAQ:CHI",
    "NYSE:DDF",
    "ARCA:DGZ",
    "NYSE:EMP",
    "ARCA:CEW",
    "NYSE:ECCW",
    "ARCA:EFO",
    "ARCA:CHAU",
    "ARCA:CWEB",
    "NYSE:DPG",
    "ARCA:DTD",
    "NYSE:EDF",
    "NYSE:EMD",
    "NYSE:EMO",
    "NASDAQ:DGRW",
    "NYSE:EGF",
    "BATS:ESGG",
    "ARCA:DJCB",
    "ARCA:EET",
    "ARCA:ELD",
    ":ETW",
    "NASDAQ:FDUSG",
    "ARCA:DRW",
    "ARCA:DTN",
    "ARCA:EBLU",
    "NYSE:ECCX",
    "NYSE:EFR",
    "NYSE:ELC",
    "NYSE:EVF",
    "ARCA:EDZ",
    "NASDAQ:EMCB",
    "NYSE:EOD",
    "ARCA:EUSC",
    "ARCA:FBT",
    "NYSE:FCRX",
    "ARCA:EEH",
    "ARCA:ERY",
    "NYSE:ETG",
    "NYSE:ETV",
    "ARCA:EUO",
    "NYSE:EOI",
    "NYSE:ETB",
    "ARCA:EUM",
    ":ESG",
    "NYSE:ETY",
    "NYSE:EVG",
    "NYSE:EVN",
    "NASDAQ:FCA",
    "ARCA:EZJ",
    "ARCA:EWV",
    "NASDAQ:FDUSZ",
    "NYSE:FFC",
    "NASDAQ:FGM",
    "ARCA:FEUL",
    "NASDAQ:FKU",
    "ARCA:FDD",
    "NYSE:FFA",
    "NASDAQ:FBZ",
    "NYSE:FCT",
    "NYSE:FIF",
    "NASDAQ:FEMS",
    "NASDAQ:FEX",
    "ARCA:FIHD",
    "ARCA:FDL",
    "NYSE:FEI",
    "ARCA:FFR",
    "ARCA:FIEE",
    "NYSE:FINS",
    ":FLGE",
    "ARCA:FISK",
    "NASDAQ:FJP",
    "NYSE:FIV",
    "NYSE:FLC",
    "NYSE:FMN",
    "NASDAQ:FSZ",
    "ARCA:FLLA",
    "ARCA:FRLG",
    "NASDAQ:FTC",
    "ARCA:FXL",
    "NYSE:GDO",
    "NASDAQ:GECCM",
    "NYSE:GGZ",
    "ARCA:FNGU",
    "NASDAQ:FNX",
    "ARCA:FVD",
    "ARCA:FXO",
    "NYSE:GAM",
    "NYSE:GDL",
    "NYSE:GIM",
    "NYSE:GJS",
    "NASDAQ:FLN",
    "ARCA:FMF",
    "NYSE:FMY",
    "NYSE:FOF",
    "ARCA:FUE",
    "ARCA:FXN",
    "ARCA:FNGZ",
    "NYSE:FPL",
    "NASDAQ:FTA",
    "ARCA:FXG",
    "ARCA:FXU",
    "NASDAQ:GBLIL",
    "NYSE:GJT",
    "ARCA:FNGO",
    "ARCA:FRI",
    "ARCA:FXB",
    "ARCA:FXR",
    "NYSE:GAB",
    "NYSE:GBAB",
    "NYSE:GCV",
    "NYSE:GDV",
    "ARCA:FLZA",
    "NYSE:FMO",
    "NYSE:FSD",
    "NASDAQ:FUND",
    "ARCA:FXZ",
    "NASDAQ:GECCL",
    "NASDAQ:FNK",
    "NYSE:FT",
    "NASDAQ:FTGC",
    "NASDAQ:FNY",
    "NYSE:FRA",
    "ARCA:GCC",
    "NASDAQ:GLDI",
    "ARCA:GNAF",
    "ARCA:GSG",
    "NYSE:GGM",
    "NYSE:HPF",
    "NASDAQ:HWCPZ",
    "ARCA:FXA",
    "ARCA:FXP",
    "ARCA:GBUG",
    "NYSE:GJR",
    "ARCA:GLL",
    "NASDAQ:GRNVR",
    "NASDAQ:GECCO",
    "NYSE:GJH",
    "NASDAQ:GRID",
    "NYSE:GGT",
    "NASDAQ:GLADL",
    "ARCA:GLDM",
    "NYSE:HCXY",
    "NYSE:HYI",
    "NYSE:GOF",
    "NYSE:GPJA",
    "NYSE:HGH",
    "NYSE:HTD",
    "NYSE:IHTA",
    "ARCA:GUNR",
    ":HYT",
    "NYSE:IAE",
    "ARCA:IDIV",
    "ARCA:GRU",
    "ARCA:HEDJ",
    "NYSE:HEQ",
    "NASDAQ:HROWL",
    "NYSE:HYB",
    "NYSE:HQL",
    "NASDAQ:HCAPZ",
    "ARCA:HDLB",
    "BATS:HEEM",
    "ARCA:HIBL",
    "NYSE:HTFB",
    "BATS:IAGG",
    "NASDAQ:INBKZ",
    "NYSE:HPI",
    "AMEX:IPB",
    "NASDAQ:HYZD",
    "NYSE:IFN",
    "NYSE:IHD",
    "NYSE:IHIT",
    "NYSE:INSI",
    "ARCA:IWFL",
    "NYSE:JBK",
    "NYSE:JDD",
    "NYSE:JHS",
    "ARCA:IHDG",
    "NYSE:IVH",
    "NYSE:JCE",
    "ARCA:JJA",
    "ARCA:IQDY",
    "NYSE:IRL",
    "NYSE:IQI",
    "NYSE:ISD",
    "NYSE:JHB",
    "NYSE:JSD",
    "BATS:IQDG",
    "ARCA:JJC",
    "NYSE:JFR",
    "ARCA:JJN",
    "NYSE:JRO",
    "ARCA:IWDL",
    "NYSE:JEQ",
    "ARCA:JJG",
    "NYSE:JPC",
    "NYSE:JRI",
    "ARCA:IWML",
    "ARCA:JDST",
    "NYSE:KYN",
    "ARCA:IXSE",
    "ARCA:JJS",
    "ARCA:JO",
    "NYSE:JRS",
    "NYSE:JQC",
    "NASDAQ:JSM",
    "ARCA:LD",
    "ARCA:LTL",
    "NYSE:MAV",
    "NYSE:MMD",
    "ARCA:LDUR",
    "NYSE:LEO",
    "ARCA:MLPO",
    "NYSE:MMT",
    "ARCA:NAIL",
    "NYSE:NCV",
    "NASDAQ:MCAER",
    "NYSE:MFD",
    "NASDAQ:MBNKP",
    "ARCA:MTUL",
    "NYSE:LGI",
    "NYSE:MCR",
    "NYSE:MCN",
    "NYSE:MGF",
    "NYSE:MGRB",
    "NYSE:MHLA",
    "NYSE:MCA",
    "NASDAQ:METCL",
    "NYSE:MFL",
    "ARCA:MIDU",
    "NYSE:MTCN",
    "ARCA:MVV",
    "NYSE:MFV",
    "NYSE:MIY",
    "NYSE:MUI",
    "ARCA:MTGP",
    "NYSE:MMU",
    "NASDAQ:MPACR",
    "NYSE:MUA",
    "NYSE:NAN",
    "NYSE:NAZ",
    "ARCA:MUNI",
    "ARCA:MVRL",
    "NYSE:NIM",
    "NYSE:NKG",
    "NYSE:MSD",
    "NYSE:NCA",
    "NYSE:MVF",
    "NYSE:NHF",
    "NYSE:NMZ",
    "NYSE:NPV",
    "ARCA:NRGU",
    "NYSE:NRUC",
    "NYSE:MYJ",
    "NASDAQ:MPACR",
    "NYSE:MUA",
    "NYSE:NAN",
    "NYSE:NAZ",
    "ARCA:MUNI",
    "ARCA:MVRL",
    "NYSE:NIM",
    "NYSE:NKG",
    "NYSE:MSD",
    "NYSE:NCA",
    "NYSE:MVF",
    "NYSE:NHF",
    "NYSE:NMZ",
    "NYSE:NPV",
    "ARCA:NRGU",
    "NYSE:NRUC",
    "NYSE:MYJ",
    "NYSE:NNY",
    "NYSE:NQP",
    "NYSE:NRGX",
    "NYSE:NBB",
    "NYSE:NBXG",
    "ARCA:NIB",
    "NYSE:NPCT",
    "NYSE:NXN",
    "NYSE:NID",
    "NYSE:NMT",
    "NYSE:NXR",
    "AMEX:NML",
    "NYSE:NOM",
    "NYSE:NRK",
    "NYSE:NSL",
    "ARCA:NTSX",
    "NYSE:NXP",
    "ARCA:NRGD",
    "NYSE:NUW",
    "ARCA:NTSE",
    "ARCA:OOTO",
    "NYSE:NUO",
    "NYSE:NXC",
    "NYSE:NVG",
    "ARCA:NUGT",
    "NYSE:NUV",
    "NYSE:OIA",
    "NASDAQ:OXLCL",
    "NYSE:PCF",
    "NYSE:PFL",
    "NASDAQ:PFXNL",
    "NYSE:PGP",
    "NYSE:PHK",
    "NYSE:PCN",
    "NYSE:NXP",
    "ARCA:NRGD",
    "NYSE:NUW",
    "ARCA:NTSE",
    "ARCA:OOTO",
    "NYSE:NUO",
    "NYSE:NXC",
    "NYSE:NVG",
    "ARCA:NUGT",
    "NYSE:NUV",
    "NYSE:OIA",
    "NASDAQ:OXLCL",
    "NYSE:PCF",
    "NYSE:PFL",
    "NASDAQ:PFXNL",
    "NYSE:PGP",
    "NYSE:PHK",
    "NYSE:PCN",
    "NYSE:PCK",
    "NYSE:PHD",
    "NYSE:PBC",
    "NYSE:PCM",
    "NYSE:PEO",
    "ARCA:PBUG",
    "ARCA:PGM",
    "NYSE:PCI",
    "NYSE:PRS",
    "NYSE:PDI",
    "NYSE:PGZ",
    "NYSE:PIM",
    "NYSE:PMO",
    "NASDAQ:PNNTG",
    "NYSE:PSF",
    "NYSE:PDT",
    "ARCA:PFFL",
    "NYSE:PFN",
    "NYSE:PHT",
    "ARCA:PILL",
    "NYSE:PMM",
    "NYSE:PYS",
    "ARCA:PLAT",
    "NYSE:PPT",
    "NYSE:PNF",
    "ARCA:PST",
    "NYSE:PYN",
    "NASDAQ:QQXT",
    "NYSE:QVCC",
    "ARCA:QLV",
    "ARCA:PSLV",
    "NYSE:PTA",
    "NYSE:PTY",
    "ARCA:PUTW",
    "ARCA:PSQ",
    "ARCA:PSR",
    "ARCA:QLD",
    "NASDAQ:QQQX",
    "ARCA:QSY",
    "NASDAQ:RILYN",
    "ARCA:RJI",
    "NYSE:PZC",
    "ARCA:QDF",
    "BATS:QLC",
    "NASDAQ:RILYM",
    "ARCA:RJA",
    "NASDAQ:QABA",
    "ARCA:QID",
    "NYSE:QVCD",
    "ARCA:RAVI",
    "NYSE:PYT",
    "ARCA:QLVD",
    "NYSE:RCC",
    "NASDAQ:RILYI",
    "NYSE:RMM",
    "ARCA:QDEF",
    "ARCA:QLVE",
    "BATS:RESD",
    "ARCA:RFUN",
    "NYSE:RGT",
    "ARCA:RALS",
    "NYSE:RCB",
    "ARCA:REK",
    "BATS:RESE",
    "NYSE:SBI",
    "ARCA:REML",
    "ARCA:RESP",
    "ARCA:REW",
    "NASDAQ:RING",
    "NASDAQ:RILYO",
    "ARCA:RJZ",
    "ARCA:RETL",
    "NASDAQ:RILYH",
    "NYSE:RMI",
    "ARCA:SCC",
    "ARCA:SCO",
    "ARCA:RIGS",
    "ARCA:RXL",
    "NYSE:SAF",
    "NYSE:SDHY",
    "NASDAQ:RILYT",
    "NYSE:RNP",
    "NYSE:RVT",
    "BATS:RODI",
    "ARCA:ROM",
    "ARCA:RXD",
    "AMEX:SCCB",
    "NYSE:RZA",
    "ARCA:SBUG",
    "NYSE:SCD",
    "ARCA:SDS",
    "BATS:SHAG",
    "ARCA:RWM",
    "ARCA:SDOW",
    "ARCA:SIJ",
    "ARCA:SAA",
    "ARCA:SBM",
    "AMEX:SCCC",
    "ARCA:SDP",
    "ARCA:SEF",
    "BATS:SFHY",
    "NYSE:RZB",
    "NYSE:SAK",
    "NYSE:SBBA",
    "ARCA:SCDL",
    "ARCA:SDCI",
    "ARCA:SGG",
    "BATS:SFIG",
    "ARCA:SLV",
    "ARCA:SPDN",
    "NYSE:SPXX",
    "NASDAQ:SQQQ",
    "ARCA:SRS",
    "NASDAQ:TANNI",
    "ARCA:TECL",
    "ARCA:SMN",
    "NYSE:SOJD",
    "NYSE:SOJB",
    "ARCA:SOYB",
    "ARCA:SMMU",
    "NASDAQ:SNCRL",
    "ARCA:SBB",
    "ARCA:SPXU",
    "ARCA:SSO",
    "NYSE:SOJE",
    "NYSE:SOR",
    "ARCA:SPXS",
    "NYSE:SRV",
    "ARCA:SPPP",
    "ARCA:SPUU",
    "ARCA:SRTY",
    "NYSE:TDF",
    "NYSE:TFSA",
    "NYSE:TDI",
    "NYSE:THQ",
    "ARCA:SSG",
    "NYSE:STK",
    "ARCA:SZK",
    "NYSE:TBC",
    "ARCA:TDTF",
    "NYSE:TEI",
    "ARCA:TLTD",
    "NYSE:SWZ",
    "NASDAQ:TANNZ",
    "NASDAQ:TDIV",
    "ARCA:TDTT",
    "NYSE:SZC",
    "NYSE:TBB",
    "NYSE:TPTA",
    "NYSE:TEAF",
    "BATS:TILT",
    "ARCA:TPAY",
    "ARCA:TLTE",
    "ARCA:TBX",
    "NYSE:TDA",
    "ARCA:TECS",
    "NYSE:TVE",
    "NYSE:TYG",
    "ARCA:UGE",
    "NYSE:UNMA",
    "ARCA:USD",
    "ARCA:USL",
    "ARCA:TIPZ",
    "ARCA:TNA",
    "ARCA:TYD",
    "ARCA:TMV",
    "ARCA:TOK",
    "ARCA:UDOW",
    "NASDAQ:TQQQ",
    "ARCA:UCC",
    "ARCA:URE",
    "NYSE:UZE",
    "NYSE:VPV",
    "ARCA:TPOR",
    "NYSE:TSI",
    "ARCA:TZA",
    "ARCA:UGL",
    "ARCA:UYM",
    "NYSE:TPZ",
    "ARCA:UCIB",
    "NYSE:UTF",
    "ARCA:UTSL",
    "ARCA:UXI",
    "NYSE:TTP",
    "ARCA:UCO",
    "ARCA:TYO",
    "ARCA:UBR",
    "NYSE:USA",
    "ARCA:USDU",
    "ARCA:UUP",
    "ARCA:UYG",
    "NASDAQ:VENAR",
    "ARCA:VIDI",
    "ARCA:UBOT",
    "BATS:USMF",
    "NYSE:UZD",
    "NYSE:VCIF",
    "NYSE:UZA",
    "NYSE:VGI",
    "ARCA:UWM",
    "NYSE:UZF",
    "NYSE:VLT",
    "NYSE:WALA",
    "NYSE:VGM",
    "NYSE:MQT",
    "ARCA:VTEB",
    "NYSE:VTN",
    "NYSE:VVR",
    "ARCA:WEBL",
    "BATS:WFIG",
    "NYSE:VTA",
    "ARCA:WANT",
    "ARCA:MYY",
    "NASDAQ:VTAQR",
    "NASDAQ:VTIP",
    "ARCA:WEAT",
    "BATS:WFHY",
    "ARCA:XLC",
    "ARCA:XLP",
    "ARCA:WEBS",
    "NASDAQ:WHFBZ",
    "NYSE:WIA",
    "ARCA:XDIV",
    "ARCA:XLI",
    "ARCA:XLU",
    "BATS:WDNA",
    "ARCA:XLRE",
    "BATS:VXX",
    "NYSE:WDI",
    "ARCA:WGLD",
    "BATS:WIL",
    "ARCA:XLK",
    "ARCA:XLY",
    "NASDAQ:WGRO",
    "ARCA:WTMF",
    "ARCA:XLB",
    "ARCA:YXI",
    "NASDAQ:ZGYHR",
    "NYSE:XFLT",
    "ARCA:YCS",
    "NASDAQ:ZIONL",
    "NYSE:ZTR",
    "ARCA:XPP",
    "BATS:XVZ",
    "ARCA:YINN",
    "ARCA:ZIG",
    "ARCA:YANG",
    "ARCA:ZSL",
    "ARCA:XSOE",
    "ARCA:ZROZ",
    "ARCA:YCL",
    "NYSE:AGD",
    "NASDAQ:SLVO",
    "ARCA:SKF",
    "ARCA:SJB",
    "NYSE:SJIJ",
    "ARCA:AGQ",
    "NYSE:AFB",
    "NYSE:AFGB",
    "ARCA:SMHB",
    "NASDAQ:SKOR",
    "NYSE:AQNA",
    "ARCA:SMDD",
    "NASDAQ:ADRE",
    "NYSE:ADX",
    "NYSE:ASG",
    "ARCA:BAR",
    "NYSE:SHO-I",
    "NYSE:EMF",
    "ARCA:FAS",
    "ARCA:DXJ",
    "ARCA:EMMF",
    "NYSE:ETO",
    "ARCA:OUNZ",
    "ARCA:SH",
    "NYSE:ATAQ.U",
    "ARCA:DIM",
    "NYSE:ENBA",
    "ARCA:ESBA",
    "NYSE:GSLD",
    "NYSE:JTA",
    "NASDAQ:ATCOL",
    "ARCA:BCM",
    "NYSE:ENJ",
    "NYSE:EOT",
    "ARCA:FXE",
    "NYSE:FCRW",
    "NASDAQ:FAD",
    "NYSE:MYD",
    "ARCA:RUSL",
    "ARCA:SDD",
    "NASDAQ:DGRS",
    "NYSE:NAC",
    "AMEX:SACC",
    "NYSE:VCV",
    "NYSE:PNI",
    "NASDAQ:SBLKZ",
    "NASDAQ:OXSQL",
    "NYSE:RMT",
    "NYSE:VKQ",
    "NASDAQ:QQQ",
    "NYSE:SREA",
    "ARCA:TAGS",
    "NASDAQ:ADOCR",
    "ARCA:STPZ",
    "NASDAQ:TANNL",
    "NYSE:AEFC",
    "ARCA:NTSI",
    "AMEX:VHAQ.RT",
    "ARCA:AMND",
    "ARCA:CPER",
    "NYSE:SPE",
    "NASDAQ:WCLD",
    "NASDAQ:DHCNI",
    "NYSE:AFGC",
    "NYSE:PFO",
    "ARCA:XLV",
    "ARCA:AMUB",
    "NYSE:AQNB",
    "NYSE:AWF",
    "NYSE:AEB",
    "NYSE:BTO",
    "NYSE:AFGD",
    "NYSE:AFT",
    "ARCA:URTY",
    "NYSE:GGT.RT",
    "NYSE:ARDC",
    "NYSE:ASA",
    "NYSE:BDJ",
    "NYSE:BKN",
    "NYSE:AWP",
    "ARCA:SOXL",
    "NYSE:BAMI",
    "ARCA:LABU",
    "NYSE:BIT",
    "NASDAQ:BIS",
    "ARCA:BKF",
    "NASDAQ:BREZR",
    "NYSE:BGX",
    "NYSE:BGR",
    "ARCA:GLD",
    "ARCA:GUSH",
    "ARCA:LABD",
    "NYSE:CII",
    "NYSE:CMU",
    "ARCA:FBGX",
    "NASDAQ:CPTAL",
    "NYSE:HIE",
    "NYSE:HIX",
    "ARCA:FXF",
    "NYSE:MHD",
    "NYSE:MPA",
    "NYSE:AJXA",
    "NASDAQ:ANGL",
    "AMEX:AEF",
    "ARCA:VSS",
    "ARCA:EEV",
    "NYSE:AIW",
    "NASDAQ:AGBAR",
    "BATS:VXZ",
    "NYSE:RCS",
    "ARCA:VUSE",
    "NYSE:RFI",
    "NYSE:EFT",
    "NYSE:RSF",
    "NYSE:PKO",
    "NASDAQ:FYX",
    "NASDAQ:RILYK",
    "NYSE:AIF",
    "NYSE:DMB",
    "ARCA:DHS",
    "ARCA:DBV",
    "ARCA:DGS",
    "NYSE:DYFN",
    "ARCA:DGP",
    "ARCA:DRIP",
    "ARCA:DPST",
    "ARCA:DLN",
    "ARCA:DBS",
    "ARCA:DOL",
    "ARCA:DON",
    "NYSE:DUKH",
    "ARCA:DLS",
    "ARCA:EPV",
    "ARCA:DIG",
    "NYSE:ECCY",
    "ARCA:DJP",
    "NYSE:DTB",
    "NYSE:DLY",
    "NYSE:DTW",
    "ARCA:DUST",
    "NYSE:EOS",
    "NYSE:DEX",
    "NYSE:DUKB",
    "ARCA:FGD",
    "ARCA:GDXD",
    "NYSE:DTY",
    "ARCA:DZZ",
    "NYSE:EAI",
    "NASDAQ:ESSCR",
    "ARCA:EUFX",
    "ARCA:DXD",
    "ARCA:EUDG",
    "NYSE:NZF",
    "NASDAQ:DXGE",
    "ARCA:EPS",
    "ARCA:ERX",
    "NYSE:FGB",
    "ARCA:TENG",
    "NASDAQ:MBTCR",
    "NYSE:SMM",
    "NYSE:ACP",
    "ARCA:AGGY",
    "NASDAQ:AGZD",
    "NYSE:AIZN",
    "ARCA:AMTR",
    "NYSE:AOD",
    "NASDAQ:ASET",
    "NYSE:ASGI",
    "BATS:ATMP",
    "NYSE:AVK",
    "ARCA:BDCX",
    "NYSE:BCX",
    "NASDAQ:BENER",
    "NYSE:BHK",
    "NYSE:BME",
    "NYSE:BMEZ",
    "NASDAQ:ARRWU",
    "NYSE:BLW",
    "ARCA:BNO",
    "NYSE:BNY",
    "ARCA:BNKD",
    "NASDAQ:BOKFL",
    "ARCA:BNKU",
    "ARCA:CANE",
    "ARCA:CAPE",
    "BATS:DDLS",
    "ARCA:DRV",
    "NYSE:DSL",
    "ARCA:DUG",
    "ARCA:FNGS",
    "ARCA:GDXU",
    "NASDAQ:GECCN",
    "NYSE:GRX",
    "NYSE:JCO",
    "ARCA:JJE",
    "NYSE:JLS",
    "ARCA:LTPZ",
    "NYSE:MVT",
    "NYSE:MXF",
    "NYSE:MYI",
    "NYSE:NEV",
    "NASDAQ:OPINL",
    "NYSE:OPP",
    "ARCA:PLTM",
    "ARCA:QDYN",
    "NASDAQ:QTEC",
    "NASDAQ:QQEW",
    "ARCA:QQQE",
    "NYSE:RQI",
    "NYSE:SOJC",
    "ARCA:SOXS",
    "ARCA:TTT",
    "ARCA:UGA",
    "ARCA:UPW",
    "NYSE:VMO",
    "NASDAQ:WCBR",
    "NYSE:WEA",
    "NYSE:RFM",
    "ARCA:AMNA",
    "NASDAQ:ANDAR",
    "ARCA:DBO",
    "NYSE:AFGE",
    "NYSE:ARGD",
    "ARCA:EMLP",
    "ARCA:EURL",
    "ARCA:FNGD",
    "BATS:IMLP",
    "NYSE:NDP",
    "NASDAQ:QCLN",
    "NYSE:SFB",
    "NASDAQ:MCADR",
    "NYSE:HFRO",
    "ARCA:UBT",
    "NYSE:VBF",
    "ARCA:EES",
    "NYSE:EVT",
    "ARCA:USCI",
]

with open("./temp/alpaca/alpaca_stocks.csv") as stocks_file:
    stocks = pd.read_csv(stocks_file)

print(stocks[~stocks["isin"].notna()].shape)

missing_isin_stocks = [
    {"exchange": isin.split(":")[0], "symbol": isin.split(":")[1]}
    for isin in missing_isins
]

missing_symbols = set(map(lambda x: x["symbol"], missing_isin_stocks))


# print(len(set(stocks[~stocks.isin(missing_symbols)]["isin"].to_list())))

print(stocks[~stocks["isin"].notna()][~stocks["symbol"].isin(missing_symbols)]["symbol"])

# for stock in tqdm(missing_isin_stocks):
#     print(stock)
# #     *link, isin = isin_link.rsplit(":", 1)
# #     exchange, symbol = "".join(link).rsplit("/", 1)[-1].split("%3A")
# #     stock_index = stocks.query("exchange == @exchange and symbol == @symbol").index[0]
# #     stocks.loc[stock_index, "isin"] = isin


# # print(stocks[~stocks["isin"].notna()].shape)

# # with open("./temp/alpaca/alpaca_stocks.csv", "w") as stocks_file:
# #     stocks.to_csv(stocks_file, index=False)
